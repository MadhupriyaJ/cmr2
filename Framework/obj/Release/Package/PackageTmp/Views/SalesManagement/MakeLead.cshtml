@model FramWork.HelloService.Person
@using Core;
@using FramWork.HelloService;
@{
    ViewBag.Title = "Lead 2 Deal | Create New Oppurtunity/ Contact";
    Layout = "~/Views/Shared/_LayoutSales.cshtml";
    HelloServiceClient client = new HelloServiceClient("BasicHttpBinding_IHelloService");
    var managepersonId = Session["managepersonId"];
}
<input type="hidden" value="@Request.Params["ID"]" id="hdnpersonid" />
<ul class="page-breadcrumb breadcrumb">
    <li>
        <a href="@Url.Content("~/")Home/Index">Home</a>
        <i class="fa fa-circle"></i>
    </li>
    <li>
        <a href="#">Sales</a>
        <i class="fa fa-circle"></i>
    </li>
    <li>
        <a href="#">PipeLine</a>
        <i class="fa fa-circle"></i>
    </li>
    <li>
        <a href="@Url.Action("SalesAgentView", "SalesManagement") ">Sales Agent View</a>
        <i class="fa fa-circle"></i>
    </li>
    <li>
        <a href="@Url.Content("~/")SalesManagement/ManagePerson/?id=@managepersonId">Manage Person</a>
        <i class="fa fa-circle"></i>
    </li>
    <li>
        <a href="#">Make Lead</a>
    </li>
</ul>
<div class="portlet light bordered">
    <div class="portlet-title">
        <div class="caption font-yellow-crusta">
            <i class="fa fa-plus-circle font-red-sunglo"></i>
            <span class="caption caption-subject bold uppercase font-red-sunglo">Make Lead</span>
            <span class="caption-helper"> Assign The contact or opportunity as lead </span>
        </div>
        <div class="actions">

        </div>
    </div>
    <div class="portlet-body">
        <div class="row">

            <div class="col-md-12">
                <div class="portlet light" id="form_wizard_1">
                    <div class="portlet-title">
                        <div class="caption">
                            Contact Create Wizard - <span class="step-title">
                                Step 1 of 3
                            </span>
                        </div>

                    </div>
                    <div class="portlet-body form">
                        <form action="#" class="form-horizontal" id="submit_form" method="POST">
                            <div class="form-wizard">
                                <div class="form-body">
                                    <ul class="nav nav-pills nav-justified steps">
                                        <li>
                                            <a href="#tab1" data-toggle="tab" class="step active">
                                                <span class="number">
                                                    1
                                                </span>
                                                <span class="desc">
                                                    <i class="fa fa-check"></i> Financial Details
                                                </span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#tab2" data-toggle="tab" class="step active">
                                                <span class="number">
                                                    2
                                                </span>
                                                <span class="desc">
                                                    <i class="fa fa-check"></i> Product Details
                                                </span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#tab3" data-toggle="tab" class="step">
                                                <span class="number">
                                                    3
                                                </span>
                                                <span class="desc">
                                                    <i class="fa fa-check"></i> Confirm
                                                </span>
                                            </a>
                                        </li>
                                    </ul>
                                    <div id="bar" class="progress progress-striped" role="progressbar">
                                        <div class="progress-bar progress-bar-success">
                                        </div>
                                    </div>
                                    <div class="tab-content">
                                        <div class="alert alert-danger display-none">
                                            <button class="close" data-dismiss="alert"></button>
                                            You have some form errors. Please check below.
                                        </div>
                                        <div class="alert alert-success display-none">
                                            <button class="close" data-dismiss="alert"></button>
                                            Your form validation is successful!
                                        </div>

                                        <div class="tab-pane active" id="tab1">
                                            <h3 class="block">Provide your Financial Details</h3>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Salary <span class="required">
                                                                *
                                                            </span>
                                                        </label>
                                                        <div class="col-md-5">
                                                            @Html.TextBox("Salary", null, new { @Value = ViewBag.txtsalary, @Placeholder = "(e.g:- QAR 2,334.00)", @Style = "text-align:right;", @Class = "currenciesOnly form-control validate[required]", @id = "Salary", @name = "Salary" })
                                                            <span class="help-block">
                                                                Provide Salary
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Current Liablility <span class="required">
                                                                *
                                                            </span>
                                                        </label>
                                                        <div class="col-md-5">
                                                            @Html.TextBox("CurrentLiablility", null, new { @Value = ViewBag.txtCurrentLiablility, @Placeholder = "(e.g:- QAR 2,334.00)", @Style = "text-align:right;", @Class = "currenciesOnly form-control validate[required]", @id = "CurrentLiablility", @name = "CurrentLiablility" })
                                                            <span class="help-block">
                                                                Provide Your Current Liablility
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Monthly Installment
                                                        </label>
                                                        <div class="col-md-5">
                                                            @Html.TextBox("MonthlyInstallment", null, new { @Value = ViewBag.txtCurrentLiablility, @Placeholder = "(e.g:- QAR 2,334.00)", @Style = "text-align:right;", @Class = "currenciesOnly form-control validate[required]", @id = "MonthlyInstallment", @name = "MonthlyInstallment" })
                                                            <span class="help-block">
                                                                Provide your Monthly Installment
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Expected Financial Value
                                                        </label>
                                                        <div class="col-md-5">
                                                            @Html.TextBox("ExpectedValue", null, new { @Value = ViewBag.txtExpectedValue, @Placeholder = "(e.g:- QAR 2,334.00)", @Style = "text-align:right;", @Class = "currenciesOnly form-control validate[required]", @id = "ExpectedValue", @name = "ExpectedValue" })
                                                            <span class="help-block">
                                                                Provide your Expected Financial Value
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Assign Lead to Team
                                                        </label>
                                                        <div class="col-md-5">
                                                            @Html.DropDownList("ddlassignedtoteam", new SelectList(client.GetTeamLst(Login.OrganizationId).Select(a => new { Id = a.Id, Name = a.Name }), "Id", "Name"), "Select", new { @class = "form-control validate[required]", @id = "ddlassignedtoteam", @name = "ddlassignedtoteam" })
                                                            <span class="help-block">
                                                                Provide your Team
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Assign Lead To
                                                        </label>
                                                        <div class="col-md-5">
                                                            @Html.DropDownList("ddlassignedtoemployee", new SelectList(client.GetEmployeeLst(Login.OrganizationId).Select(a => new { Id = a.Id, FullName = a.User.FirstName + " " + a.User.LastName }), "Id", "FullName"), "Select", new { @class = "form-control validate[required]", @id = "ddlassignedtoemployee", @name = "ddlassignedtoemployee" })
                                                            <span class="help-block">
                                                                Select your Employee/Agent
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <h3 class="block">Provide  Other details</h3>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Expected Closing Date
                                                        </label>
                                                        <div class="col-md-8">
                                                            @Html.TextBox("ExpectedClosingDate", null, new { @maxlength = "21", @placeholder = "MM/DD/YYYY", @Class = "form-control date-picker", @id = "ExpectedClosingDate", @name = "ExpectedClosingDate"  })
                                                            <span class="help-block">
                                                                Provide  Expected Closing Date
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Special Comments
                                                        </label>
                                                        <div class="col-md-5">
                                                            @Html.TextArea("txtdesc", null, new { @Value = ViewBag.txtActualValue, @Placeholder = "Description", @Class = "currenciesOnly form-control ",@rows="4" })
                                                            <span class="help-block">
                                                                Provide  Comments Here
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tab2">
                                            <h3 class="block">Provide  Product details</h3>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Campaign
                                                        </label>
                                                        <div class="col-md-5">
                                                            @Html.DropDownList("Campaign", new SelectList(client.GetLstCampaign(Login.OrganizationId).Select(a => new { Id = a.Id, Description = a.Description }), "Id", "Description"), "Select", new { @class = "form-control validate[required]", @id = "Campaign", @name = "Campaign" })
                                                            <span class="help-block">
                                                                Provide your Campaign
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>


                                            <div class="row" id="productrow">
                                                <div class="col-md-6">
                                                    <!-- BEGIN Portlet PORTLET-->
                                                    <div class="portlet light">
                                                        <div class="portlet-title">
                                                            <div class="caption">
                                                                Select Product

                                                            </div>
                                                        </div>
                                                        <div class="portlet-body">
                                                            <table class="table table-striped table-bordered table-advance table-hover" style="min-height:0 !important;">
                                                                <thead>
                                                                    <tr>
                                                                        <th><i class="fa fa-shopping-cart"></i> Products</th>
                                                                    </tr>
                                                                </thead>

                                                                <tbody>
                                                                    <tr>
                                                                        <td>
                                                                            <div id="product" style="border-radius:7px;">

                                                                            </div>

                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>


                                                        </div>
                                                    </div>
                                                    <!-- END Portlet PORTLET-->
                                                </div>
                                            </div>
                                        </div>

                                        <div class="tab-pane" id="tab3">
                                            <h3 class="block">Basic information</h3>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Salutation
                                                        </label>
                                                        <div class="col-md-5">
                                                            <p class="form-control-static" data-display="Salutation">
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            First Name
                                                        </label>
                                                        <div class="col-md-5">
                                                            <p class="form-control-static" data-display="FirstName">
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Middle Name
                                                        </label>
                                                        <div class="col-md-5">
                                                            <p class="form-control-static" data-display="MiddleName">
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Last Name
                                                        </label>
                                                        <div class="col-md-5">
                                                            <p class="form-control-static" data-display="LastName">
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Nick Name
                                                        </label>
                                                        <div class="col-md-5">
                                                            <p class="form-control-static" data-display="NickName">
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                            Gender
                                                        </label>
                                                        <div class="col-md-5">
                                                            <p class="form-control-static" data-display="Gender">
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-4">
                                                <img id="profilepic" src="#" alt="your image" style="width:200px;" />
                                            </div>

                                        </div>
                                    </div>

                                    <div class="form-actions">
                                        <div class="row">
                                            <div class="col-md-offset-3 col-md-9">
                                                <a href="javascript:;" class="btn default button-previous">
                                                    <i class="m-icon-swapleft"></i> Back
                                                </a>
                                                <a href="javascript:;" class="btn blue button-next">
                                                    Continue <i class="m-icon-swapright m-icon-white"></i>
                                                </a>
                                                <a href="javascript:;" class="btn green button-submit">
                                                    Submit <i class="m-icon-swapright m-icon-white"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </form>
                    </div>

                </div>
            </div>


        </div>
    </div>
</div>






@section Scripts{
    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <script type="text/javascript" src="@Url.Content("~/")assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
    <script type="text/javascript" src="@Url.Content("~/")assets/global/plugins/jquery-validation/js/jquery.validate.min.js"></script>
    <script type="text/javascript" src="@Url.Content("~/")assets/global/plugins/jquery-validation/js/additional-methods.min.js"></script>
    <script type="text/javascript" src="@Url.Content("~/")assets/global/plugins/bootstrap-wizard/jquery.bootstrap.wizard.min.js"></script>
    <!-- END PAGE LEVEL PLUGINS -->
    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <script type="text/javascript" src="@Url.Content("~/")assets/global/plugins/select2/select2.min.js"></script>
    <!-- END PAGE LEVEL PLUGINS -->
    <!-- BEGIN PAGE LEVEL SCRIPTS -->
    <script type="text/javascript" src="@Url.Content("~/")assets/Programmer/Scripts/MakeLead/formwizardmakelead.js"></script>
    <script src="@Url.Content("~/")assets/global/plugins/bootbox/bootbox.min.js" type="text/javascript"></script>
    <!-- END PAGE LEVEL SCRIPTS -->
    <script>
        jQuery(document).ready(function () {
            FormWizard.init();

            $('#productrow').hide();

            $('#Campaign').change(function () {
                $('#productrow').show();
                var Cid = $('select[name="Campaign"] option:selected').val();
                var dataRow = ({ CampaignId: Cid });
                $.ajax({
                    type: 'POST',
                    url: '@Url.Content("~")SalesManagement/GetProductList',
                    data: dataRow,
                    success: function (result) {
                        if (result != null) {
                            var prodcutlst = result["CampaignProdcutLst"];
                            $("#product").html('');

                            $(prodcutlst).each(function (index, element) {

                                $("#product").append('<input type="checkbox" id="product' + index + '" name="product' + index + '"  value="' + prodcutlst[index].ProductName + '" >' + prodcutlst[index].ProductName + '<br/ >');
                            });
                        }
                        else {
                            bootbox.alert("Error, could not complete the action!", function () {
                                window.location.reload();
                            });
                        }

                    }
                });


            });


        });
    </script>
<script>
    /**/
    $("input[type=text].currenciesOnly").live('keydown', currenciesOnly)
                         .live('blur', function () { $(this).formatCurrency(); });

    // JavaScript I wrote to limit what types of input are allowed to be keyed into a textbox
    var allowedSpecialCharKeyCodes = [46, 8, 37, 39, 35, 36, 9];
    var numberKeyCodes = [44, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105];
    var commaKeyCode = [188];
    var decimalKeyCode = [190, 110];

    function numbersOnly(event) {
        var legalKeyCode =
            (!event.shiftKey && !event.ctrlKey && !event.altKey)
                &&
            (jQuery.inArray(event.keyCode, allowedSpecialCharKeyCodes) >= 0
                ||
            jQuery.inArray(event.keyCode, numberKeyCodes) >= 0);

        if (legalKeyCode === false)
            event.preventDefault();
    }

    function numbersAndCommasOnly(event) {
        var legalKeyCode =
            (!event.shiftKey && !event.ctrlKey && !event.altKey)
                &&
            (jQuery.inArray(event.keyCode, allowedSpecialCharKeyCodes) >= 0
                ||
            jQuery.inArray(event.keyCode, numberKeyCodes) >= 0
                ||
            jQuery.inArray(event.keyCode, commaKeyCode) >= 0);

        if (legalKeyCode === false)
            event.preventDefault();
    }

    function decimalsOnly(event) {
        var legalKeyCode =
            (!event.shiftKey && !event.ctrlKey && !event.altKey)
                &&
            (jQuery.inArray(event.keyCode, allowedSpecialCharKeyCodes) >= 0
                ||
            jQuery.inArray(event.keyCode, numberKeyCodes) >= 0
                ||
            jQuery.inArray(event.keyCode, commaKeyCode) >= 0
                ||
            jQuery.inArray(event.keyCode, decimalKeyCode) >= 0);

        if (legalKeyCode === false)
            event.preventDefault();
    }

    function currenciesOnly(event) {
        var legalKeyCode =
            (!event.shiftKey && !event.ctrlKey && !event.altKey)
                &&
            (jQuery.inArray(event.keyCode, allowedSpecialCharKeyCodes) >= 0
                ||
            jQuery.inArray(event.keyCode, numberKeyCodes) >= 0
                ||
            jQuery.inArray(event.keyCode, commaKeyCode) >= 0
                ||
            jQuery.inArray(event.keyCode, decimalKeyCode) >= 0);

        // Allow for $
        if (!legalKeyCode && event.shiftKey && event.keyCode == 52)
            legalKeyCode = true;

        if (legalKeyCode === false)
            event.preventDefault();
    }


    // jQuery formatCurrency plugin... see http://code.google.com/p/jquery-formatcurrency/
    (function ($) {
        $.formatCurrency = {}; $.formatCurrency.regions = []; $.formatCurrency.regions[""] = { symbol: "", positiveFormat: "%s%n", negativeFormat: "(%s%n)", decimalSymbol: ".", digitGroupSymbol: ",", groupDigits: true };
        $.fn.formatCurrency = function (destination, settings) {
            if (arguments.length == 1 && typeof destination !== "string") {
                settings = destination; destination = false
            } var defaults = { name: "formatCurrency", colorize: false, region: "", global: true, roundToDecimalPlace: 2, eventOnDecimalsEntered: false }; defaults = $.extend(defaults, $.formatCurrency.regions[""]);
            settings = $.extend(defaults, settings); if (settings.region.length > 0) { settings = $.extend(settings, getRegionOrCulture(settings.region)) } settings.regex = generateRegex(settings);
            return this.each(function () {
                $this = $(this); var num = "0"; num = $this[$this.is("input, select, textarea") ? "val" : "html"](); if (num.search("\\(") >= 0) {
                    num = "-" + num
                } if (num === "" || (num === "-" && settings.roundToDecimalPlace === -1)) { return } if (isNaN(num)) {
                    num = num.replace(settings.regex, ""); if (num === "" || (num === "-" && settings.roundToDecimalPlace === -1)) {
                        return
                    } if (settings.decimalSymbol != ".") { num = num.replace(settings.decimalSymbol, ".") } if (isNaN(num)) { num = "0" }
                } var numParts = String(num).split("."); var isPositive = (num == Math.abs(num));
                var hasDecimals = (numParts.length > 1); var decimals = (hasDecimals ? numParts[1].toString() : "0"); var originalDecimals = decimals; num = Math.abs(numParts[0]);
                num = isNaN(num) ? 0 : num; if (settings.roundToDecimalPlace >= 0) {
                    decimals = parseFloat("1." + decimals); decimals = decimals.toFixed(settings.roundToDecimalPlace);
                    if (decimals.substring(0, 1) == "2") { num = Number(num) + 1 } decimals = decimals.substring(2)
                } num = String(num); if (settings.groupDigits) {
                    for (var i = 0; i < Math.floor((num.length - (1 + i)) / 3) ;
                    i++) { num = num.substring(0, num.length - (4 * i + 3)) + settings.digitGroupSymbol + num.substring(num.length - (4 * i + 3)) }
                } if ((hasDecimals && settings.roundToDecimalPlace == -1) || settings.roundToDecimalPlace > 0) {
                    num += settings.decimalSymbol + decimals
                } var format = isPositive ? settings.positiveFormat : settings.negativeFormat; var money = format.replace(/%s/g, settings.symbol); money = money.replace(/%n/g, num);
                var $destination = $([]); if (!destination) { $destination = $this } else { $destination = $(destination) } $destination[$destination.is("input, select, textarea") ? "val" : "html"](money);
                if (hasDecimals && settings.eventOnDecimalsEntered && originalDecimals.length > settings.roundToDecimalPlace) {
                    $destination.trigger("decimalsEntered", originalDecimals)
                } if (settings.colorize) { $destination.css("color", isPositive ? "black" : "red") }
            })
        }; $.fn.toNumber = function (settings) {
            var defaults = $.extend({ name: "toNumber", region: "", global: true }, $.formatCurrency.regions[""]);
            settings = jQuery.extend(defaults, settings); if (settings.region.length > 0) { settings = $.extend(settings, getRegionOrCulture(settings.region)) } settings.regex = generateRegex(settings);
            return this.each(function () {
                var method = $(this).is("input, select, textarea") ? "val" : "html"; $(this)[method]($(this)[method]().replace("(", "(-").replace(settings.regex, ""))
            })
        }; $.fn.asNumber = function (settings) {
            var defaults = $.extend({ name: "asNumber", region: "", parse: true, parseType: "Float", global: true }, $.formatCurrency.regions[""]);
            settings = jQuery.extend(defaults, settings); if (settings.region.length > 0) { settings = $.extend(settings, getRegionOrCulture(settings.region)) } settings.regex = generateRegex(settings);
            settings.parseType = validateParseType(settings.parseType); var method = $(this).is("input, select, textarea") ? "val" : "html"; var num = $(this)[method]();
            num = num ? num : ""; num = num.replace("(", "(-"); num = num.replace(settings.regex, ""); if (!settings.parse) { return num } if (num.length == 0) { num = "0" } if (settings.decimalSymbol != ".") {
                num = num.replace(settings.decimalSymbol, ".")
            } return window["parse" + settings.parseType](num)
        }; function getRegionOrCulture(region) {
            var regionInfo = $.formatCurrency.regions[region]; if (regionInfo) {
                return regionInfo
            } else { if (/(\w+)-(\w+)/g.test(region)) { var culture = region.replace(/(\w+)-(\w+)/g, "$1"); return $.formatCurrency.regions[culture] } } return null
        } function validateParseType(parseType) {
            switch (parseType.toLowerCase()) {
                case "int": return "Int";
                case "float": return "Float"; default: throw "invalid parseType"
            }
        } function generateRegex(settings) {
            if (settings.symbol === "") {
                return new RegExp("[^\\d" + settings.decimalSymbol + "-]", "g")
            } else { var symbol = settings.symbol.replace("$", "\\$").replace(".", "\\."); return new RegExp(symbol + "|[^\\d" + settings.decimalSymbol + "-]", "g") }
        }
    })(jQuery);
</script>

}

